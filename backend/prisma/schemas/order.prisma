import {CartItem} from "./cartItem"
import {User} from "./user"
import {Cart} from "./cart"

enum OrderStatus {
  PENDING
  COMPLETED
  CANCELLED
  SHIPPED
  DELIVERED
  RETURNED
}

enum OrderAddressType {
  SDEK
  RU_POST
}

enum OrderPaymentState {
  PAID
  NOT_PAID
}

model Order {
  id          String      @id @default(uuid())
  userId      String
  firstName   String      @map("first_name") 
  lastName    String      @map("last_name") 
  secondName  String?     @map("second_name") 
  cartId      String      @unique
  status      OrderStatus @default(PENDING)
  payementStatus      OrderPaymentState @default(NOT_PAID) 
  totalAmount Float
  totalPrice  Float
  address     String
  comment     String?
  addressType OrderAddressType
  orderTrackId  Int?         @default(autoincrement())    
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  user        User        @relation("UserOrders", fields: [userId], references: [id])
  cart        Cart        @relation("CartOrder", fields: [cartId], references: [id])
  items       CartItem[]  @relation("OrderItems") 

  @@index([userId])
  @@index([cartId])
  
  @@map("orders")
}
